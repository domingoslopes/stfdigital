<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
        <meta content="IE=edge" http-equiv="X-UA-Compatible">
        
        <title>STF Digital Developers | Arquitetura</title>
        
        <!-- STYLESHEETS -->
        <link rel="stylesheet" href="assets/styles/fonts.css" type="text/css" >
        <link rel="stylesheet" href="assets/styles/fonts1.css" title="roboto" type="text/css">
        
        <link href="assets/styles/default.css" rel="stylesheet" type="text/css">
    </head>

    <body class="gc-documentation develop guide  dac-nav-open" itemscope="" itemtype="http://schema.org/Article">
        <header id="header-wrapper">
            <div class="dac-header" id="header">
                <div class="dac-header-inner">
                    <a class="dac-nav-toggle" data-dac-toggle-nav="" href="../index.html" title="Open navigation"> 
                        <span class="dac-nav-hamburger"> 
                            <span class="dac-nav-hamburger-top"></span> 
                            <span class="dac-nav-hamburger-mid"></span> 
                            <span class="dac-nav-hamburger-bot"></span>
                        </span>
                    </a>
                    <a class="dac-header-logo" href="../index.html">
                        <img class="dac-header-logo-image" src="../assets/images/logo.png" srcset="../assets/images/logo.png" width="32" height="32">STF Digital
                    </a>
                    <ul class="dac-header-tabs">
                        <li><a class="dac-header-tab selected" href="#">Desenvolvimento</a></li>
                    </ul>
                    <a class="dac-header-console-btn" href="https://github.com/supremotribunalfederal/stfdigital" target="_blank" > 
                        <img src="../assets/images/github-icon.png" srcset="../assets/images/github-icon.png" />
                        <span class="dac-visible-desktop-inline">Repositório</span>
                    </a>
                </div>
            <!--/.header-wrap.wrap-->
            </div>
        <!--/.header-->
        </header>
    
        <a name="navigation" tabindex="0" class="nav-start-marker">navigation</a>

        <nav class="dac-nav">
            <div class="dac-nav-dimmer" data-dac-toggle-nav=""></div>
            <div class="dac-nav-sidebar" data-swap="" data-dynamic="false" data-transition-speed="300" data-dac-nav="">
                <div data-swap-container="">
                    <a class="dac-nav-back-button dac-swap-section dac-up dac-active" tabindex="0" data-swap-button="" href="../index.html"> 
                        <i class="dac-sprite dac-nav-back"></i> 
                        <span class="dac-nav-back-title">Arquitetura</span>
                    </a>
    
                    <div class="dac-nav-sub dac-swap-section dac-right dac-active">
                        <ul id="nav">
                            <li class="nav-section expanded">
                                <div class="nav-section-header">
                                    <a href="#">Iniciando</a>
                                </div>
                                <ul style="display: block;">
                                    <li><a href="../iniciando/definicao.html">O que é o STF Digital</a></li>
                                    <li><a href="../iniciando/montagem.html">Monte seu Ambiente</a></li>
                                    <li><a href="../iniciando/demonstracao.html">Demonstração</a></li>
                                </ul>
                            </li>
                            </br>
                            <li class="nav-section expanded">
                                <div class="nav-section-header">
                                    <a href="#">Arquitetura</a>
                                </div>
                                <ul style="display: block;">
                                    <li><a href="../arquitetura/visao.html">Nossa Visão</a></li>
                                    <li><a href="../arquitetura/estrategia.html">Estratégia Arquitetural</a></li>
                                    <li><a href="../arquitetura/implantacao.html">Estratégia de Implantação</a></li>
                                </ul>
                            </li>
                            </br>
                            <li class="nav-section expanded">
                                <div class="nav-section-header">
                                    <a href="#">Padrões e Políticas</a>
                                </div>
                                <ul style="display: block;">
                                    <li><a href="../politicas/testes.html">Estratégia de Testes</a></li>
                                    <li><a href="../politicas/api.html">Gestão da API</a></li>
                                    <li><a href="../politicas/codigo-limpo.html">Código Limpo</a></li>
                                    <li><a href="../politicas/diretorios.html">Estrutura de diretórios</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
    
                </div>
            </div>
        </nav>

        <a name="top" tabindex="0"></a>
    
        <div class="wrap clearfix" id="body-content">
            <div class="content-header">
                <ul class="dac-header-crumbs dac-has-content">
                    <li class="dac-header-crumbs-item"><a class="dac-header-crumbs-link" href="#">Desenvolvimento</a></li>
                    <li class="dac-header-crumbs-item"><a class="dac-header-crumbs-link" href="#">Iniciando</a></li>
                    <li class="dac-header-crumbs-item"><a class="dac-header-crumbs-link" href="#">Monte seu Ambiente</a></li>
                </ol>
                <h1 itemprop="name">Monte seu Ambiente</h1>
            </div>
            <div id="jd-content">
                <div class="jd-descr" itemprop="articleBody">
                    <p>
                        <i>Usamos Gradle, Docker, Eclipse e Visual Studio Code para trabalhar nos serviços do STF Digital.
                        Usamos Gradle como ferramenta de construção, Docker para montar a infra local necessária,
                        Eclipse para trabalhar no código de back-end e Visual Studio Code para trabalhar no 
                        código de front-end.</i>
                    </p>

                    <p>    
                        <i>O tutorial abaixo foi criado para o Sistema Operacional Windows. Alguns passos foram documentados 
                        também para Linux. Siga os passos abaixo para deixar seu ambiente pronto para
                        começar a trabalhar. Caso encontre alguma dificuldade, entre em contato com Rodrigo Barreiros no 
                        e-mail rodrigo.barreiros@stf.jus.br.</i>
                    </p>

                    <h3 id="" style="padding-bottom: 0px;">Instale o JDK 8</h4>
                    <hr>

                    <p>
                    Digite javac -version e caso não tenha instalado a versão 8, baixe o <a target="_blank" href="http://www.oracle.com/technetwork/pt/java/javase/downloads/jdk8-downloads-2133151.html">Java JDK 8</a> e instale.
                    </p>
                        
                    <p>
                    Crie uma nova variável de ambiente chamada JAVA_HOME com o endereço da instalação do JDK (ex: C:\Program Files\Java\jdk1.8.0_91)
                    Adicione na variável Path ";%JAVA_HOME%\bin"
                    </p>
                        
                    <p>
                    Execute o comando javac - version para verficar se a instalação foi realizada com sucesso.
                    </p>
                    
                    <h3 id="comece" style="padding-bottom: 0px;">Baixe a IDE recomendada: Spring Tool Suite</h3>
                    <hr>

                    <p>    
                        Baixe o <a target="_blank" href="https://spring.io/tools">Eclipse STS (Spring Tool Suite)</a>. 
                        Enquanto o download é realizado, continue configurando o ambiente...
                    </p>

                    <h3 id="comece" style="padding-bottom: 0px;">Monte o ambiente</h3>
                    <hr>
                    
                    <h4 id="comece" style="padding-bottom: 0px;">Instale o Docker Toolbox com Git e VirtualBox</h4>
                    <hr>

                    <p>    
                        Instale o <a target="_blank" href="https://www.docker.com/products/docker-toolbox">Docker ToolBox 1.12.0+</a>.
                    </p> 

                    <h4 id="comece" style="padding-bottom: 0px;">Instale o Gradle</h4>
                    <hr>

                    <p>    
                        Cada componente deverá ser construído separadamente, portanto cada um tem seu próprio arquivo de construção. 
                        Usamos Gradle como ferramenta de montagem, então você precisa instalá-lo antes de prosseguir.
                    </p>     

                    </p>
                        
                    <p>
                        <a target="_blank" href="http://gradle.org/gradle-download/">Baixe o binário do Gradle</a> e extraia o zip para o diretório de sua preferência. Adicione o diretório bin (SeuDiretorioGradle\gradle-2.13\bin) na variável de ambiente "Path" do seu sistema operacional.
                    </p>
                        
                    <p>
                    Para configurar a variável de ambiente no windows clique com o botão direito em Meu Computador > Propriedades > Configurações avançadas do sistema > Variáveis de Ambiente > Clique duas vezes em Path e inclua ";SeuDiretorioGradle\gradle-2.13\bin". Depois clique em OK.
                    </p>
                        
                    <p>

                    <h4 id="" style="padding-bottom: 0px;">Atualize o Virtual Box</h4>
                    <hr>

                    <p>    
                        Apesar da instalação do Virtual Box com o Docker ToolBox, recomendamos sua atualização para a versão mais recente (5.0.20+) em:  <a target="_blank" href="https://www.virtualbox.org/wiki/Downloads">Baixar Virtual Box</a>.
                    </p>
                        
                    <p>
                        Execute o Docker Quick Start Terminal como administrador para executar a máquina virtual. Ele criará as interfaces de redes virtuais.
                    </p>
                        
                    <p>
                        Pare a máquina virtual com o seguinte comando: `docker-machine stop default`. Abra o Virtual Box clique com o botão direito na máquina virtual <i>default</i>, clique em configurações > Sistema > Aumente a Memória Base para 3GB (3072MB). Esse passo é importante por rodarmos mais de 10 containers simultâneos. Feche e abra o Docker Quickstart novamente para aplicar as alterações e levantar a máquina novamente.
                    </p>
                        
                    <h4 id="comece" style="padding-bottom: 0px;">Configure seus hosts</h4>
                    <hr>
                        
                    <p>
                        Para facilitar o acesso a <i>Docker Machine</i>, relacione seu IP ao alias "docker". Para identificar o IP da <i>Docker Machine</i>, execute o comando abaixo:
                    </p>
                        
                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">docker-machine ip</span></pre>                        
                    </p>
                        
                    <p>
                        Copie o endereço de IP e, no Windows, abra o arquivo                        
                    </p>
                        
                    <p>
                        <pre class="prettyprint"><span class="pln">C:\Windows\System32\drivers\etc\hosts</span></pre>                        
                    </p>
                        
                    <p>
                        E adicione as linhas abaixo:
                    </p>
                        
                    <p>
                        <pre class="prettyprint"><span class="pln">192.168.99.100 docker discovery cassandra rabbit gateway documents oracle</span>
<span class="pln">192.168.99.100 processos identidades elk onlyoffice elasticsearch</span></pre>
                    </p>
                        
                    <p>
                        No Linux, isso pode ser feito adicionando uma entrada no arquivo `/etc/hosts`, como no exemplo abaixo 
                    </p>
                        
                    <p>
                        <pre class="prettyprint"><span class="pln">192.168.99.100 docker discovery cassandra rabbit gateway documents oracle</span>
<span class="pln">192.168.99.100 processos identidades elk onlyoffice elasticsearch</span></pre>
                    </p>
                        
                    <p>
                        Você poderá confirmar se esse relacionamento está funcional executando o comando `ping` contra o alias criado.
                    </p>
                        
                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">ping docker</span></br><span class="pln">PING docker (192.168.99.100): 56 data bytes</span></br><span class="pln">64 bytes from 192.168.99.100: icmp_seq=0 ttl=64 time=0.314 ms</span></br><span class="pln">64 bytes from 192.168.99.100: icmp_seq=1 ttl=64 time=0.340 ms</span></br><span class="pln">64 bytes from 192.168.99.100: icmp_seq=2 ttl=64 time=0.386 ms</span></br></pre>
                    </p>

                    <h4 id="conectividade-externa" style="padding-bottom: 0px;">Libere as portas do gateway e ui para conectividade externa</h4>
                    <hr>

                    <p>
                        Como os microserviços estão executando em um container que roda em uma máquina virtual, por padrão esses containers não são acessíveis
                        de outras máquinas da rede (a máquina virtual do Docker utiliza o modo de rede NAT). Entretanto, há algumas situações em que se deseja
                        que esses containers sejam acessíveis. Por exemplo, caso deseje mostrar o sistema em execução a partir de outra máquina da rede, isso só
                        será possível realizando essa configuração. Um outro caso em que é essencial realizar essa configuração é para conseguir integrar
                        o sistema com um servidor Onlyoffice que não esteja rodando como container na sua própria máquina.
                    </p>
                    <p>
                        Como a imagem do Onlyoffice recomenda pelo menos 2GB de RAM para rodar seus containers, optamos por rodar um único container compartilhado para todos
                        os desenvolvedores, de modo que ele não onere recursos da máquina do desenvolvedor. Para liberar as portas, execute os passos a seguir:
                    </p>

                    <ol>
                        <li>Abra o Oracle VirtualBox</li>
                        <li>Clique com  o botão direito do mouse sobre a máquina virtual do Docker (o nome padrão é default)</li>
                        <li>Clique em Configurações</li>
                        <li>Clique em Rede</li>
                        <li>Clique em Avançado</li>
                        <li>Clique em Redirecionamento de Portas</li>
                        <li>Adicione um Redirecionamento com Porta do Hospedeiro 8765 e Porta do Convidado 8765 (não precisa preencher os IPs)</li>
                        <li>Adicione um Redirecionamento com Porta do Hospedeiro 8443 e Porta do Convidado 8443 (não precisa preencher os IPs)</li>
                        <li>Clique em OK</li>
                        <li>Clique em OK</li>
                    </ol>                    

                    <p>
                        Agora já poderá acessar o sistema a partir de outra máquina da rede nas portas 8443 (para acessar a interface gráfica) e
                        8765 (para acessar o gateway).
                    </p>

                    <h4 id="conectividade-externa-variavel" style="padding-bottom: 0px;">Configurando variáveis de ambiente</h4>
                    <hr>

                    <p>
                        Para configurar variáveis de ambiente no Windows, acesse a seguinte tela:
                    </p>

                    <ol>
                        <li>Abra o Painel de Controle</li>
                        <li>Acesse "Sistema e Segurança"/"Sistema"</li>
                        <li>Acesse "Configurações avançadas do sistema"</li>
                        <li>Acesse "Variáveis de Ambiente..."</li>
                        <li>Poderá adicionar uma nova variável de ambiente de usuário pelo botão "Novo..." logo abaixo da primeira lista de variáveis</li>
                    </ol>

                    <p>
                    A variável de ambiente HOST_ADDRESS é utilizada para permitir a aplicação parametrizar alguns componentes que precisam acessar
                    a sua máquina de desenvolvimento externamente. É o caso do Onlyoffice já mencionado. Adicione ela com o valor do IP de sua máquina
                    acessível externamente (o IP da interface que está no domínio rede.stf.gov.br).
                    </p>

                    <p>
                        O cliente Docker precisa de algumas variáveis de ambiente para se conectar com o daemon Docker que está rodando em máquina virtual. Quando
                        se abre um "Docker Quickstart Terminal" essas variáveis já são configuradas automaticamente.
                        Caso deseje executar comandos Docker de um outro terminal (um Git Bash, por exemplo), pode-se configurar essas variáveis executando o comando
                        <code>eval $(docker-machine env)</code>. Para não precisar digitar isso toda vez que abrir um novo "Git Bash" e para conseguir executar
                        construções Gradle pelo Eclipse que utilizem Docker, pode-se configurar essas variáveis diretamente no Windows. Para saber quais são essas
                        variáveis e seus valores, execute:
<pre class="prettyprint">docker-machine env</pre>
cujo resultado será algo parecido com:
<pre class="prettyprint">export DOCKER_TLS_VERIFY="1"
export DOCKER_HOST="tcp://192.168.99.100:2376"
export DOCKER_CERT_PATH="C:\Users\&lt;usuario&gt;\.docker\machine\machines\default"
export DOCKER_MACHINE_NAME="default"</pre>
                    </p>

                    <p>
                        Adicione essas variáveis no Windows como descrito acima.
                    </p>
                        
                    <h4 id="" style="padding-bottom: 0px;">Instale o Node e o NPM</h4>
                    <hr>
                        
                    <p>
                    Você também precisará ter a versão mais recente do  <a href="https://nodejs.org/dist/v5.9.1/" target="_blank">NodeJS 5.9  (já inclui NPM)</a>. Sugerimos 5.9.1+. Não baixe versão superior a NodeJS 6+, ela ainda não foi testada.
                    </p>
                        
                    <p>
                    Após instalar o NodeJs, feche e abra novamente o Docker QuickStart Terminal (para recuperar as novas variáveis de ambiente).
                    Para verificar se o NodeJS e o NPM estão instalados corretamente, execute os comandos: 
                    </p>
                        
                    <p>
                        <pre class="prettyprint"><span class="pln">node -v</span></br><span class="pln">npm -v</span></pre>                        
                    </p>
                        
                    <h4 id="" style="padding-bottom: 0px;">Instale o Gulp</h4>
                    <hr>
                    
                    <p>
                    Execute o seguinte comando para instalar o gulp globalmente:
                    </p>

                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">npm install -g gulp</span></pre>                        
                    </p>
                    
                    <h4 id="" style="padding-bottom: 0px;">Instale o Maven (opcional)</h4>
                    <hr>
                        
                    <p>
                    O Maven ainda não é necessário nesse passo, mas você pode baixá-lo em <a href="https://maven.apache.org/download.cgi" target="_blank">Maven</a>. Ele deverá ser configurado adequadamente para que o Gradle reutilize as bibliotecas já existentes em seu repositório local. Falaremos sobre esse passo mais adiante.
                    </p>

                    <h3 id="" style="padding-bottom: 0px;">Configure o Eclipse para começar a codificar</h3>
                    <hr>

                    <p>
                    Usamos <a target="_blank" href="https://spring.io/tools">Eclipse STS</a> como IDE. Certifique-se que você tem a última versão. 
                    Você também precisará instalar os seguintes plugins:
                    </p>

                    <ol>
                        <li> Buildship: Eclipse Plug-ins for Gradle</li>
                        <li> Typescript.java</li>
                    </ol>

                    <h4 id="" style="padding-bottom: 0px;">Instalando o plugin do Gradle para Eclipse</h4>
                    <hr>

                    <p>
                    Para baixar o plugin do Gradle siga os passos abaixo:
                    </p>

                    <ol>
                        <li> abra o Eclipse,</li>
                        <li> clique em Help</li>
                        <li> "Install New Software...".</li>
                        <li> Selecione Work with Neon.</li>
                        <li> Procure General Purpose Tools/Buildship: Eclipse Plug-ins for Gradle.</li>
                        <li> Next, Next, Finish.</li>
                    </ol>

                    <h4 id="" style="padding-bottom: 0px;">Instalando o reconhecimento da sintaxe do Typescript</h4>
                    <hr>

                    <p>
                        Apesar de recomendarmos o Visual Studio Code para codificar o front-end, também há a opção de instalar o seguinte plugin
                        para Eclipse, caso prefira utilizar apenas o Eclipse. (Observação: esse plugin ainda não suporta validação de padrão de codificação
                        em tempo de codificação)
                    </p>
                    <p>
                    Para instalar o reconhecimento da sintaxe do Typescript <a href="https://github.com/angelozerr/typescript.java/wiki/Installation%20Update%20Site" target="_blank">Typescript.java</a> siga os passos abaixo:
                    </p>

                    <ol>
                        <li> Abra o Eclipse > clique em Help > Install New Software... > ADD.</li>

                        <li> Inclua em location site o link do typescript.java "http://oss.opensagres.fr/typescript.ide/1.1.0-SNAPSHOT/". O nome pode ser Typescript.java Update site.</li>

                        <li> Marque todas as opções e clique em Next, Next, Finish.</li>
                    </ol>
                    
                    <h4 id="" style="padding-bottom: 0px;">Alterando a codificação padrão do Eclipse</h4>
                    <hr>

                    <p>
                        O Eclipse, por padrão, cria projetos com codificação ISO-8859-1 para seus arquivos. O STF Digital utiliza, por questões de
                        padronização, a codificação UTF-8. Por isso, é necessário alterar essas codificação no Eclipse. Para isso, execute os passos a seguir:
                    </p>

                    <ol>
                        <li> Abra o Eclipse,</li>
                        <li> Clique em Window/Preferences</li>
                        <li> Clique em General/Workspace</li>
                        <li> Selecione o Text file encoding: Other</li>
                        <li> Selecione UTF-8</li>
                        <li> Clique em OK</li>
                    </ol>

                    <h4 id="" style="padding-bottom: 0px;">Ativando a sincronização do Eclipse com arquivos alterados externamente</h4>
                    <hr>

                    <p>
                        Como utilizamos o Gulp para construção de front-end e o Eclipse não monitora por padrão arquivos alterados externamente,
                        é necessário ativar essa opção no Eclipse para que o código front-end servido pelo back-end esteja sempre atualizado.
                        Para ativar essa opção no Eclipse, execute os passos a seguir:
                    </p>

                    <ol>
                        <li> Abra o Eclipse,</li>
                        <li> Clique em Window/Preferences</li>
                        <li> Clique em General/Workspace</li>
                        <li> Selecione "Refresh using native hooks or polling</li>
                        <li> Clique em OK</li>
                    </ol>

                    <h3 id="" style="padding-bottom: 0px;">Instale o Visual Studio Code e plugins</h3>
                    <hr>

                    <p>
                    Usamos o <a target="_blank" href="https://code.visualstudio.com">Visual Studio Code</a> como IDE para front-end. Certifique-se que você tem a última versão. 
                    Você também precisará instalar os seguintes plugins:
                    </p>
                    
                    <ol>
                        <li><a href="https://marketplace.visualstudio.com/items?itemName=eg2.tslint" target="_blank">TSLint</a>, que é utilizado para verificar se o código está de acordo
                        com o <a href="../politicas/codigo-limpo.html#padrao-codificao-frontend">padrão de codificação de front-end</a> em tempo de codificação</li>
                    </ol>
                    
                    <h3 id="desenvolvendo-contexto-especifico">Desenvolvendo para um contexto específico</h3>
                    <hr>
                    
                    <p>Quando uma equipe está desenvolvendo em apenas um contexto, eles não precisam ficar construindo esses contextos localmente. Como
                    as imagens docker dos outros contextos já são construídas na integração contínua e os desenvolvedores <i>normalmente</i>
                    não precisam alterar nada nessas imagens, eles podem baixá-las diretamente de um
                    registro docker. Nesta seção estão os procedimentos para utilizar essa abordagem de desenvolvimento.
                    
                    <h4 id="desenvolvendo-contexto-baixar" style="padding-bottom: 0px;">Baixe o repositório do contexto</h4>
                    <hr>

                    <p>    
                        Abra o <b>Docker Quickstart Terminal</b> e na sua pasta de preferência (ex: /c/dev) , para baixar o repositório 
                        e execute os comandos abaixo:
                    </p>
                    
                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">git clone https://github.com/supremotribunalfederal/stfdigital-autuacao-recebimento.git</span>
<span class="str">$ </span><span class="pln">cd stfdigital-autuacao-recebimento</span></pre>
                    </p>
                    
                    <h4 id="" style="padding-bottom: 0px;">Atualize as imagens dos outros contextos a partir do Docker Hub/Registro Corporativo</h4>
                    Para desenvolver para um contexto específico, é recomendável manter sempre as imagens locais dos outros contextos sempre atualizadas.
                    Para atualizá-las, basta executar o comando logo abaixo. Execute esse comando com frequência diária pelo menos ou quando for notificado
                    (via Slack, por exemplo) de que uma imagem foi atualizada.
                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">docker-compose pull</span></pre>                        
                    </p>
                    
                    <p>Depois de executar o comando acima, é preciso sempre executar o comando da próxima seção para que os serviços em execução
                    estejam sempre atualizados.</p>
                    
                    <h4 id="" style="padding-bottom: 0px;">Execute os containers docker dos outros contextos</h4>
                    <hr>
                    
                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">docker-compose up -d</span></pre>                        
                    </p>
                    
                    <h4 id="" style="padding-bottom: 0px;">Acompanhe os logs com Kitematic</h4>
                    <hr>

                    <p>
                    Abra o Kitematic (que já foi instalado com o Docker Toolbox) ou acompanhe as mensagens de log pelo comando: 
                    </p>

                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">docker-compose logs</span></pre>                        
                    </p>

                    <p>
                    A medida que os serviços forem iniciados, eles serão registrados automaticamente no serviço de discovery. Acesse `http://discovery:8761` para acompanhar o registro dos serviços. Quando todos estiverem registrados, você deverá ver a tabela como no exemplo abaixo:
                    </p>

                    <div>
                        <img src="assets/images/discovery.png" width="900">
                    </div>
                    
                    <h4 id="eclipse-importacao" style="padding-bottom: 0px;">Importe o projeto no Eclipse</h4>
                    <hr>

                    <p>Importe os projetos no Eclipse com os seguintes passos:</p>
                    <ol>
                        <li> Clique com o botão direito na view Package Explorer</li>
                        <li> Clique em Import</li>
                        <li> Clique em Gradle - aparecerá se o plugin Gradle estiver instalado corretamente</li>
                        <li> Clique em Gradle Project</li>
                        <li> Clique em Next, Next</li>
                        <li> Clique em Browse</li>
                        <li> Selecione o diretório do projeto (ex: stfdigital/autuacao/recebimento)</li>
                        <li> clique em Next, Next, Finish `é normal demorar na primeira execução`</li>
                    </ol>
                    
                    <h4 id="eclipse-profile" style="padding-bottom: 0px;">Configure o profile da aplicação</h4>
                    <hr>
                    <ol>
                        <li>Abra a view Boot Dashboard</li>
                        <li>Clique com o botão direito no projeto do contexto (recebimento, por exemplo)</li>
                        <li>Clique em Open Config</li>
                        <li>Preencha o campo Profile com <code>development</code></li>
                        <li>Clique em Apply, depois em Close</li>
                    </ol>
                    
                    <h4 id="eclipse-executar" style="padding-bottom: 0px;">Execute a aplicação back-end pelo Eclipse</h4>
                    <hr>
                    <p>
                        Antes de realizar esse passo, é necessário verificar que o contexto <code>discovery</code> já tenha terminado
                        de subir. Isso é necessário pois as configurações dos contextos estão centralizadas no discovery.
                        Para verificar isso acesse <a href="http://discovery:8761">http://discovery:8761</a>. Se essa página carregar,
                        significa que ele já está rodando com sucesso e os passos abaixo já podem ser executados.
                    </p>
                    <ol>
                        <li>Abra a view Boot Dashboard</li>
                        <li>Clique com o botão direito no projeto do contexto (recebimento, por exemplo)</li>
                        <li>Clique em (Re)rebug</li>
                    </ol>
                    
                    <h4 id="" style="padding-bottom: 0px;">Instale as dependências de front-end do projeto</h4>
                    <hr>
                    
                    <p>
                        Execute o seguinte comando a partir do diretório do projeto para instalar as dependências de front-end:
                    <p>
                    
                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">npm install</span></pre>
                    </p>
                    
                    <h4 id="eclipse-build-front-end" style="padding-bottom: 0px;">Execute a construção e <i>watch</i> do código do front-end</h4>
                    <hr>
                    <ol>
                        <li>Abra um terminal Git Bash (ou Docker Quickstart Terminal)</li>
                        <li>Acesse a raiz da aplicação (por exemplo, stfdigital/autuacao/recebimento)</li>
                        <li>Execute um dos seguintes comandos:
                        <p>
                        Apenas monitora e constrói os recursos de frontend
                        </p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">gulp watch</span></pre>
                        <p>
                        Monitora os recursos de frontend e roda um browsersync, recarregando a página toda vez que uma alteração for feita.
                        </p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">gulp serve:dev</span></pre>
                        </li>
                    </ol>
                    
                    <h4 id="eclipse-build-front-end" style="padding-bottom: 0px;">Acesse a aplicação pelo browser</h4>
                    <hr>
                    
                    <p>
                        Acesse a aplicação no browser pelo endereço <a href="http://docker:8443" target="_blank">http://docker:8443</a> . Caso tenha iniciado a construção de front-end
                        pelo comando <code>gulp serve:dev</code>, poderá acessar pelo endereço <a href="http://localhost:3000" target="_blank">http://localhost:3000</a>, para ter o browsersync
                        sincronizando os recursos de front-end.
                    </p>
                    
                    <h3 id="desenvolvendo-tudo">Desenvolvendo para todos os contextos</h3>
                    <hr>
                    
                    <p>
                        As instruções a partir daqui são apenas para os desenvolvedores que desejam poder desenvolver para todos os contextos do STF Digital
                        ao mesmo tempo. De modo geral, não é necessário seguir esses passos, pois o desenvolvedor de apenas um contexto poderá trabalhar normalmente
                        apenas naquele contexto, desde que sempre atualize suas imagens dos outros contextos com <code>docker-compose pull</code>.
                    </p>
                    <h4 id="comece" style="padding-bottom: 0px;">Baixe o repositório</h4>
                    <hr>

                    <p>    
                        Abra o <b>Docker Quickstart Terminal</b> e na sua pasta de preferência (ex: /c/dev) , para baixar o repositório 
                        e execute os comandos abaixo:
                    </p>

                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">git clone https://github.com/supremotribunalfederal/stfdigital.git</span></br><span class="str">$ </span><span class="pln">cd stfdigital</span></br><span class="str">$ </span><span class="pln">./clone-all.sh</span></pre>
                    </p>
                        
                    <p>
                        Isso deve resultar na seguinte estrutura de diretórios:
                    </p>

                    <div>
                        <img src="assets/images/estrutura.png" width="180">
                    </div>                    
                    
                    <h4 id="" style="padding-bottom: 0px;">Execute o Script Gradle</h4>
                    <hr>
                        
                    <p>
                    Para facilitar o processo, temos um pequeno script que pode ser usado para construir todos os componentes de uma vez.  
                    </p>

                    <p>
                    Agora podemos rodar o script de construção do ambiente. 
                    Reinicie o Docker Quickstart terminal para carregar as variaveis de ambiente e entre no diretório que clonou o ambiente e execute o comando abaixo:
                    </p>

                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">./build-all.sh</span></pre>                        
                    </p>

                    <p>
                    A execução do script Gradle termina com a geração da imagem docker de cada componente. 
                    </p>

                    <p>
                    `Vá tomar um café! Esse passo demora mesmo!` 
                    </p>

                    <p>
                    Isso deverá resultar em <b>sete mensagens</b> iguais a mensagem de log abaixo:
                    </p>

                    <p>
                        <pre class="prettyprint"><span class="pln">BUILD SUCCESSFUL</span></pre>                        
                    </p>

                    <p>
                    Neste ponto, todas as imagens docker já foram geradas.
                    </p>

                    <p>
                    Execute o comando
                    </p>

                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">docker images</span></pre>                        
                    </p>

                    <p>
                    E veja o resultado abaixo:
                    </p>

                    <p>
                        <pre class="prettyprint"><span class="pln">REPOSITORY                                 TAG                 IMAGE ID            CREATED             SIZE</span></br><span class="pln">stfdigital-plataforma-ui                   latest              38625052905a        2 minutes ago       254.1 MB</span></br><span class="pln">stfdigital-autuacao-distribuicao           latest              59bc4671989e        4 minutes ago       254.4 MB</span></br><span class="pln">stfdigital-autuacao-autuacao               latest              087a6508857d        4 minutes ago       254.3 MB</span></br><span class="pln">stfdigital-plataforma-documents            latest              415ed3e38505        About an hour ago   272.5 MB</span></br><span class="pln">stfdigital-plataforma-identidades   latest              7a39edcc72e3        About an hour ago   254.3 MB</span></br><span class="pln">stfdigital-plataforma-processos             latest              960b2163c474        About an hour ago   254.5 MB</span></br><span class="pln">stfdigital-plataforma-gateway              latest              187aa4d0f0ef        About an hour ago   214.5 MB</span></br><span class="pln">stfdigital-plataforma-discovery            latest              1527e91ead85        About an hour ago   212.6 MB</span></br><span class="pln">stfdigital-autuacao-recebimento            latest              db7b10569848        About an hour ago   254.5 MB</span></br><span class="pln">stfdigital-autuacao-peticionamento         latest              26289ebe34f2        About an hour ago   254.5 MB</span></pre>                        
                    </p>

                    <h4 id="" style="padding-bottom: 0px;">Pronto! Execute a aplicação!</h4>
                    <hr>
                    </p>

                    <p>
                    Você poderá rodar todas elas de uma única vez usando <i>Docker Compose</i>: 
                    </p>

                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">docker-compose up -d</span></pre>                        
                    </p>

                    <h4 id="" style="padding-bottom: 0px;">Acompanhe os logs com Kitematic</h4>
                    <hr>

                    <p>
                    Abra o Kitematic (que já foi instalado com o Docker Toolbox) ou acompanhe as mensagens de log pelo comando: 
                    </p>

                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">docker-compose logs</span></pre>                        
                    </p>

                    <p>
                    A medida que os serviços forem iniciados, eles serão registrados automaticamente no serviço de discovery. Acesse `http://discovery:8761` para acompanhar o registro dos serviços. Quando todos estiverem registrados, você deverá ver a tabela como no exemplo abaixo:
                    </p>

                    <div>
                        <img src="assets/images/discovery.png" width="900">
                    </div>

                    <h4 id="" style="padding-bottom: 0px;">Para trabalhar com UI...</h4>
                    <hr>

                    <p>
                    Rode no diretório plataforma/ui os comandos abaixo e pare o container de UI pelo Kitematic
                    </p>

                    <p>
                        <pre class="prettyprint"><span class="pln">npm install</span></br><span class="pln">gulp serve</span></pre>                        
                    </p>

                    <h4 id="" style="padding-bottom: 0px;">Importando os projetos no Eclipse</h4>
                    <hr>

                    <p>
                    Você vai precisar importar todos os componentes separadamente. Você pode importar cada projeto diretamente pelo Eclipse, como um Projeto Gradle, ou pode executar o comando abaixo, no diretório de cada projeto, para gerar os arquivos necessários antes de importá-lo como um projeto já existente. 
                    </p>

                    <h4 id="" style="padding-bottom: 0px;">Digitando o comando (substitui o próximo passo)</h4>
                    <hr>

                    <p>
                    Abra o <b>Git Bash</b> e na raiz do STF Digital, para gerar os arquivos de importação do eclipse, digite:
                    </p>

                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">./import-all.sh</span></pre>                        
                    </p>

                    <p>
                        Ou rode manualmente o comando abaixo em cada pasta que deseja trabalhar:
                    </p>

                    <p>
                        <pre class="prettyprint"><span class="str">$ </span><span class="pln">gradle eclipse</span></pre>                        
                    </p>

                    <p>
                    Após rodar o comando, um arquivo chamado .project e uma pasta .settings serão criados permitindo importação do projeto no eclipse. Para importar siga os passos abaixo:
                    </p>

                    <ol>
                        <li> Clique com o botão direito na view Package Explorer</li>
                        <li> Clique em Import</li>
                        <li> Clique em General > Existing Projects into Workspace</li>
                        <li> Selecione o diretório em que você rodou o comando "gradle eclipse"</li>
                    </ol>

                    <p>
                    Repita os passos para cada um dos componentes.
                    </p>

                    <h4 id="" style="padding-bottom: 0px;">Usando apenas o Eclipse (substitui o passo anterior)</h4>
                    <hr>

                    <ol>
                        <li> Clique com o botão direito na view Package Explorer</li>
                        <li> Clique em Import</li>
                        <li> Clique em Gradle - aparecerá se o plugin Gradle estiver instalado corretamente</li>
                        <li> Clique em Gradle Project</li>
                        <li> Clique em Next, Next</li>
                        <li> Clique em Browse</li>
                        <li> Selecione o diretório do projeto (ex: stfdigital/autuacao/recebimento)</li>
                        <li> clique em Next, Next, Finish `é normal demorar na primeira execução`</li>
                    </ol>

                    <h4 id="" style="padding-bottom: 0px;">Organizando os projetos nos Working Sets "Área de Negócio" e "Plataforma"</h4>
                    <hr>
                    </p>

                    <p>
                    Se optar por uma organização com <i>Working Sets</i>, você deverá ter uma estrutura de projetos como na imagem abaixo:
                    </p>

                    <div>
                        <img src="assets/images/eclipse.png" width="160">
                    </div>

                    <ol>
                        <li> Clique com o botão direito no nome do projeto</li>
                        <li> Assign Working Sets</li>
                        <li> Selecione Autuação ou Plataforma, por exemplo</li>
                        <li> No cabeçalho da view Package Explorer, clique na seta para baixo</li>
                        <li> Top Level Elements > Working Set</li>
                    </ol>
                </div>
    
            </div>
            <!-- end jd-content -->
        </div>
        <!--/#body-content-->
    </body>
</html>
