package br.jus.stf.processamentoinicial.autuacao.interfaces.actions;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;

import br.jus.stf.plataforma.shared.actions.annotation.ActionController;
import br.jus.stf.plataforma.shared.actions.annotation.ActionMapping;
import br.jus.stf.processamentoinicial.autuacao.domain.model.PeticaoStatus;
import br.jus.stf.processamentoinicial.autuacao.domain.model.TipoDevolucao;
import br.jus.stf.processamentoinicial.autuacao.interfaces.commands.AssinarDevolucaoPeticaoCommand;
import br.jus.stf.processamentoinicial.autuacao.interfaces.commands.AutuarPeticaoCommand;
import br.jus.stf.processamentoinicial.autuacao.interfaces.commands.DevolverPeticaoCommand;
import br.jus.stf.processamentoinicial.autuacao.interfaces.commands.PreautuarPeticaoFisicaCommand;
import br.jus.stf.processamentoinicial.autuacao.interfaces.facade.PeticaoServiceFacade;

@ActionController(groups = "peticao")
public class PeticaoActionsResource {
	
	@Autowired
	private PeticaoServiceFacade peticaoServiceFacade;
	
	@ActionMapping(id = "preautuar", name = "Preautuar Petição Física")
	public void preautuar(PreautuarPeticaoFisicaCommand command) {
<<<<<<< HEAD
		peticaoServiceFacade.preautuar(command.getPeticaoId(), command.getClasseId(), command.isValida(), command.getMotivo(), command.getPreferencias());
=======
		peticaoServiceFacade.preautuar(command.getPeticaoId(), command.getClasseId(), command.isValida(), command.getMotivo());
>>>>>>> 7965cb1e7e3900742fc32cedd61893eaf72fdfef
	}
	
	@ActionMapping(id = "autuar", name = "Autuar Petição")
	public void autuar(AutuarPeticaoCommand command) {
		peticaoServiceFacade.autuar(command.getPeticaoId(), command.getClasseId(), command.isValida(), command.getMotivo()); 
	}
	
	@ActionMapping(id = "devolver-peticao", name = "Devolver Petição")
	public void devolver(DevolverPeticaoCommand command) {
		TipoDevolucao tipoDevolucao = TipoDevolucao.valueOf(command.getTipoDevolucao());
		peticaoServiceFacade.devolver(command.getPeticaoId(), tipoDevolucao, command.getNumeroOficio()); 
	}
	
	@ActionMapping(id = "assinar-devolucao-peticao", name = "Assinar Documento de Devolução")
	@FiltrarPeticaoPorStatus(PeticaoStatus.ASSINAR_DEVOLUCAO)
	public void assinarDevolucao(List<AssinarDevolucaoPeticaoCommand> commands) {
		commands.forEach(c -> peticaoServiceFacade.assinarDevolucao(c.getPeticaoId(), c.getDocumentoId()));
	}
	
}
